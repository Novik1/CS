#
# This script is Copyright (C) 2004-2021 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.1 $
# $Date: 2021/06/25 $
#
#     description : Tenable ZTE ROSNG Best Practices Audit v1.0.0.
#     Checks are developed based on ZXROSNG Product Security Baseline
#     Published 21 Jun2 2021
#
#<ui_metadata>
#<display_name>Tenable ZTE ROSNG Best Practices</display_name>
#<spec>
#  <type>TNS</type>
#  <name>Tenable ZTE ROSNG Best Practices</name>
#  <version>1.0.0</version>
#</spec>
#<labels>tenable,zte</labels>
#</ui_metadata>

<check_type:"ZTE_ROSNG">

## 7  Management Layer Security Requirements
# 7.1 (1.1) Secure Login and Telnet Disabling

<custom_item>
  type        : CONFIG_CHECK
  description : "1.1 Secure Login and Telnet Disabling - Enable SSH server"
  info        : "From the perspective of security, the management plane should support at least the SSH/SSL login mode. Ordinary plain text Telnet/ftp login is vulnerable to attack, and such secure login modes as SSH and SFTP should be supported. The session validity period must be limited."
  solution    : "It is recommended to enable ssh server

				Enable SSH server by running:
				ZXR10 (config)#ssh server enable"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "^ssh server enable"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,NIAv2|SS15a,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "1.1 Secure Login and Telnet Disabling - Disable telnet server"
  info        : "From the perspective of security, the management plane should support at least the SSH/SSL login mode. Ordinary plain text Telnet/ftp login is vulnerable to attack, and such secure login modes as SSH and SFTP should be supported. The session validity period must be limited."
  solution    : "It is recommended to disable telnet server.

				Disable telnet server by running:
				ZXR10 (config)#line telnet server disable"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "^line telnet server disable"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
</custom_item>

# 7.2 (1.2) Password Security Policy

<custom_item>
  type        : CONFIG_CHECK
  description : "1.2 Password Security Policy - a) The default password length shouldn't be below 8 characters"
  info        : "Strong passwords are supported to prevent passwords from being cracked. When a password is set, password complexity is detected by default. If a password does not meet the policy, a warning is required. A strong password mode should be provided. The password verification mechanism is as follows:

				 a)	The default password length shouldn't be below 8 characters.
				 b)	The password must include either three of 'number', 'capital', 'lowercase', 'special-character' or set the 'character-set-num' value to 3-4
				 c)	Configure 'strong-password dictionary' and 'same-consecutive' to avoid weak password
				 d)	Check either of the following words exist in configuration file:
						-	Encrypt none
						-	Authentication null
						-	Encrypted null
						-	Encryption null
						-	Security-protocol noauth
						-	Encrypted noauth
				 e)	If 'strong-password max-length' not displayed in configuration, then pass this check.
				    If 'strong-password max-length' displayed in configuration, but max-length value below 10, or not both configuration 'username-related-chk inverse' and 'strong-password date-check enable' commands, then fail this check.
				 f)	The validity period of an account can be configured."
  solution    : "It is recommended to set password length to at least 8 characters

				 ZXR10# configure terminal
				 ZXR10 (config)# system-user
				 ZXR10 (config-system-user)# strong-password length 8"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : ".*strong-password length ([8-9]|[1-9][0-9]|\\d{3,}).+"
  section     : "system-user"
  reference   : "800-171|3.5.7,800-53|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "1.2 Password Security Policy - b) The password must include either three of 'number', 'capital', 'lowercase', 'special-character' or set the 'character-set-num' value to 3-4"
  info        : "Strong passwords are supported to prevent passwords from being cracked. When a password is set, password complexity is detected by default. If a password does not meet the policy, a warning is required. A strong password mode should be provided. The password verification mechanism is as follows:

				 a)	The default password length shouldn't be below 8 characters.
				 b)	The password must include either three of 'number', 'capital', 'lowercase', 'special-character' or set the 'character-set-num' value to 3-4
				 c)	Configure 'strong-password dictionary' and 'same-consecutive' to avoid weak password
				 d)	Check either of the following words exist in configuration file:
						-	Encrypt none
						-	Authentication null
						-	Encrypted null
						-	Encryption null
						-	Security-protocol noauth
						-	Encrypted noauth
				 e)	If 'strong-password max-length' not displayed in configuration, then pass this check.
				    If 'strong-password max-length' displayed in configuration, but max-length value below 10, or not both configuration 'username-related-chk inverse' and 'strong-password date-check enable' commands, then fail this check.
				 f)	The validity period of an account can be configured."
  solution    : "It is recommended to set password consists of digits, letters, and symbols

				 ZXR10# configure terminal
				 ZXR10 (config)# system-user
				 ZXR10 (config-system-user)# strong-password length 8 character number capital lowercase special-character"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "(.*strong-password length .+ character number capital lowercase special-character|.*strong-password length .+ character number capital lowercase|.*strong-password length .+ character number capital special-character|.*strong-password length .+ character number lowercase special-character|.*strong-password length .+ character capital lowercase special-character)|(.*strong-password length .+ character-set-num [3-4])"
  section     : "system-user"
  reference   : "800-171|3.5.7,800-53|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "1.2 Password Security Policy - c) Configure 'strong-password dictionary' and 'same-consecutive' to avoid weak password - strong-password dictionary"
  info        : "Strong passwords are supported to prevent passwords from being cracked. When a password is set, password complexity is detected by default. If a password does not meet the policy, a warning is required. A strong password mode should be provided. The password verification mechanism is as follows:

				 a)	The default password length shouldn't be below 8 characters.
				 b)	The password must include either three of 'number', 'capital', 'lowercase', 'special-character' or set the 'character-set-num' value to 3-4
				 c)	Configure 'strong-password dictionary' and 'same-consecutive' to avoid weak password
				 d)	Check either of the following words exist in configuration file:
						-	Encrypt none
						-	Authentication null
						-	Encrypted null
						-	Encryption null
						-	Security-protocol noauth
						-	Encrypted noauth
				 e)	If 'strong-password max-length' not displayed in configuration, then pass this check.
				    If 'strong-password max-length' displayed in configuration, but max-length value below 10, or not both configuration 'username-related-chk inverse' and 'strong-password date-check enable' commands, then fail this check.
				 f)	The validity period of an account can be configured."
  solution    : "It is recommended to set password to support check of simple passwords and weak passwords

				 ZXR0# configure terminal
				 ZXR10 (config)# system-user
				 ZXR10 (config-system-user)# strong-password dictionary"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : ".*strong-password dictionary"
  section     : "system-user"
  reference   : "800-171|3.5.7,800-53|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "1.2 Password Security Policy - c) Configure 'strong-password dictionary' and 'same-consecutive' to avoid weak password - same-consecutive"
  info        : "Strong passwords are supported to prevent passwords from being cracked. When a password is set, password complexity is detected by default. If a password does not meet the policy, a warning is required. A strong password mode should be provided. The password verification mechanism is as follows:

				 a)	The default password length shouldn't be below 8 characters.
				 b)	The password must include either three of 'number', 'capital', 'lowercase', 'special-character' or set the 'character-set-num' value to 3-4
				 c)	Configure 'strong-password dictionary' and 'same-consecutive' to avoid weak password
				 d)	Check either of the following words exist in configuration file:
						-	Encrypt none
						-	Authentication null
						-	Encrypted null
						-	Encryption null
						-	Security-protocol noauth
						-	Encrypted noauth
				 e)	If 'strong-password max-length' not displayed in configuration, then pass this check.
				    If 'strong-password max-length' displayed in configuration, but max-length value below 10, or not both configuration 'username-related-chk inverse' and 'strong-password date-check enable' commands, then fail this check.
				 f)	The validity period of an account can be configured."
  solution    : "It is recommended to set password to support check of simple passwords and weak passwords

				 ZXR10# configure terminal
				 ZXR10 (config)# system-user
				 ZXR10 (config-system-user)# strong-password same-consecutive 5"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : ".*strong-password same-consecutive .+"
  section     : "system-user"
  reference   : "800-171|3.5.7,800-53|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK_NOT
  description : "1.2 Password Security Policy - d) Check either of the following words exist in configuration file"
  info        : "Strong passwords are supported to prevent passwords from being cracked. When a password is set, password complexity is detected by default. If a password does not meet the policy, a warning is required. A strong password mode should be provided. The password verification mechanism is as follows:

				 a)	The default password length shouldn't be below 8 characters.
				 b)	The password must include either three of 'number', 'capital', 'lowercase', 'special-character' or set the 'character-set-num' value to 3-4
				 c)	Configure 'strong-password dictionary' and 'same-consecutive' to avoid weak password
				 d)	Check either of the following words exist in configuration file:
						-	Encrypt none
						-	Authentication null
						-	Encrypted null
						-	Encryption null
						-	Security-protocol noauth
						-	Encrypted noauth
				 e)	If 'strong-password max-length' not displayed in configuration, then pass this check.
				    If 'strong-password max-length' displayed in configuration, but max-length value below 10, or not both configuration 'username-related-chk inverse' and 'strong-password date-check enable' commands, then fail this check.
				 f)	The validity period of an account can be configured."
  solution    : "It is recommended config to support stores passwords in ciphertext, do not include the following phrases in the configuration:

				 - encrypt none
				 - authentication null
				 - encrypted null
				 - encryption null
				 - security-protocol noauth
				 - encrypted noauth"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "(encrypt none|(authentication|encrypted|encryption) null|(security-protocol|encrypted) noauth)"
  reference   : "800-171|3.5.10,800-53|IA-5(1)(c),CSF|PR.AC-1,ITSG-33|IA-5(1)(c),NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.1"
</custom_item>

<if>
  <condition type:"AND">
#Check if strong-password max-length has been enabled

    <custom_item>
      type        : CONFIG_CHECK_NOT
      description : "Check if strong-password max-length has been enabled"
      item        : ".*strong-password max-length"
      section     : "system-user"
    </custom_item>
  </condition>

  <then>
#If it is not enabled

    <report type:"PASSED">
      description : "1.2 Password Security Policy - e) Check for strong-password max-length"
      info        : "Strong passwords are supported to prevent passwords from being cracked. When a password is set, password complexity is detected by default. If a password does not meet the policy, a warning is required. A strong password mode should be provided. The password verification mechanism is as follows:

						 a)	The default password length shouldn't be below 8 characters.
						 b)	The password must include either three of 'number', 'capital', 'lowercase', 'special-character' or set the 'character-set-num' value to 3-4
						 c)	Configure 'strong-password dictionary' and 'same-consecutive' to avoid weak password
						 d)	Check either of the following words exist in configuration file:
								-	Encrypt none
								-	Authentication null
								-	Encrypted null
								-	Encryption null
								-	Security-protocol noauth
								-	Encrypted noauth
						 e)	If 'strong-password max-length' not displayed in configuration, then pass this check.
							If 'strong-password max-length' displayed in configuration, but max-length value below 10, or not both configuration 'username-related-chk inverse' and 'strong-password date-check enable' commands, then fail this check.
						 f)	The validity period of an account can be configured.

						 Note: strong-password max-length has been not been configured by default."
      solution    : "It is recommended to set the maximum password length to at least 10

						 ZXR10# configure terminal
						 ZXR10 (config)# system-user
						 ZXR10 (config-system-user)# strong-password max-length 64"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-171|3.5.7,800-53|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
    </report>
  </then>

  <else>
#If it is enabled.

    <if>
#Check for the presence of strong-password username-related-chk and strong-password date-check enable

      <condition type:"AND">
        <custom_item>
          type        : CONFIG_CHECK
          description : "Check if strong-password dictionary has been enabled"
          item        : ".*strong-password username-related-chk"
          section     : "system-user"
        </custom_item>

        <custom_item>
          type        : CONFIG_CHECK
          description : "Check if strong-password same-consecutive has been enabled"
          item        : ".*strong-password date-check enable"
          section     : "system-user"
        </custom_item>
      </condition>

      <then>
#If both parameters are enabled together

        <custom_item>
          type        : CONFIG_CHECK
          description : "1.2 Password Security Policy - e) Check for strong-password max-length - strong-password username-related-chk inverse"
          info        : "Strong passwords are supported to prevent passwords from being cracked. When a password is set, password complexity is detected by default. If a password does not meet the policy, a warning is required. A strong password mode should be provided. The password verification mechanism is as follows:

								 a)	The default password length shouldn't be below 8 characters.
						         b)	The password must include either three of 'number', 'capital', 'lowercase', 'special-character' or set the 'character-set-num' value to 3-4
						         c)	Configure 'strong-password dictionary' and 'same-consecutive' to avoid weak password
						         d)	Check either of the following words exist in configuration file:
								    -	Encrypt none
								    -	Authentication null
								    -	Encrypted null
								    -	Encryption null
								    -	Security-protocol noauth
								    -	Encrypted noauth
						         e)	If 'strong-password max-length' not displayed in configuration, then pass this check.
							        If 'strong-password max-length' displayed in configuration, but max-length value below 10, or not both configuration 'username-related-chk inverse' and 'strong-password date-check enable' commands, then fail this check.
						         f)	The validity period of an account can be configured."
          solution    : "It is recommended to set the password to irrelevant to the username and date.

								 ZXR10# configure terminal
								 ZXR10 (config)# system-user
								 ZXR10 (config-system-user)# strong-password username-related-chk inverse"
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          item        : ".*strong-password username-related-chk"
          section     : "system-user"
          reference   : "800-171|3.5.7,800-53|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
        </custom_item>

        <custom_item>
          type        : CONFIG_CHECK
          description : "1.2 Password Security Policy - e) Check for strong-password max-length - strong-password date-check enable"
          info        : "Strong passwords are supported to prevent passwords from being cracked. When a password is set, password complexity is detected by default. If a password does not meet the policy, a warning is required. A strong password mode should be provided. The password verification mechanism is as follows:

								 a)	The default password length shouldn't be below 8 characters.
						         b)	The password must include either three of 'number', 'capital', 'lowercase', 'special-character' or set the 'character-set-num' value to 3-4
						         c)	Configure 'strong-password dictionary' and 'same-consecutive' to avoid weak password
						         d)	Check either of the following words exist in configuration file:
								    -	Encrypt none
								    -	Authentication null
								    -	Encrypted null
								    -	Encryption null
								    -	Security-protocol noauth
								    -	Encrypted noauth
						         e)	If 'strong-password max-length' not displayed in configuration, then pass this check.
							        If 'strong-password max-length' displayed in configuration, but max-length value below 10, or not both configuration 'username-related-chk inverse' and 'strong-password date-check enable' commands, then fail this check.
						         f)	The validity period of an account can be configured."
          solution    : "It is recommended to set the password to irrelevant to the username and date.

								 ZXR10# configure terminal
								 ZXR10 (config)# system-user
								 ZXR10 (config-system-user)# strong-password date-check enable"
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          item        : ".*strong-password date-check enable"
          section     : "system-user"
          reference   : "800-171|3.5.8,800-53|IA-5(1)(e),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(e),NESA|T5.2.3,NIAv2|AM22c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3"
        </custom_item>
      </then>

      <else>
#If either one of the parameters is not enabled

        <report type:"FAILED">
          description : "1.2 Password Security Policy - e) Check for strong-password max-length - strong-password username-related-chk inverse"
          info        : "Strong passwords are supported to prevent passwords from being cracked. When a password is set, password complexity is detected by default. If a password does not meet the policy, a warning is required. A strong password mode should be provided. The password verification mechanism is as follows:

								  a)	The default password length shouldn't be below 8 characters.
								  b)	The password must include either three of 'number', 'capital', 'lowercase', 'special-character' or set the 'character-set-num' value to 3-4
								  c)	Configure 'strong-password dictionary' and 'same-consecutive' to avoid weak password
								  d)	Check either of the following words exist in configuration file:
										-	Encrypt none
										-	Authentication null
										-	Encrypted null
										-	Encryption null
										-	Security-protocol noauth
										-	Encrypted noauth
								  e)	If 'strong-password max-length' not displayed in configuration, then pass this check.
										If 'strong-password max-length' displayed in configuration, but max-length value below 10, or not both configuration 'username-related-chk inverse' and 'strong-password date-check enable' commands, then fail this check.
								  f)	The validity period of an account can be configured.

								 Note: Either strong-password username-related-chk inverse or strong-password date-check enable has not been configured."
          solution    : "It is recommended to set the password to irrelevant to the username and date.

								 ZXR10# configure terminal
								 ZXR10 (config)# system-user
								 ZXR10 (config-system-user)# strong-password username-related-chk inverse"
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          reference   : "800-171|3.5.7,800-53|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
        </report>

        <report type:"FAILED">
          description : "1.2 Password Security Policy - e) Check for strong-password max-length - strong-password date-check enable"
          info        : "Strong passwords are supported to prevent passwords from being cracked. When a password is set, password complexity is detected by default. If a password does not meet the policy, a warning is required. A strong password mode should be provided. The password verification mechanism is as follows:

								  a)	The default password length shouldn't be below 8 characters.
								  b)	The password must include either three of 'number', 'capital', 'lowercase', 'special-character' or set the 'character-set-num' value to 3-4
								  c)	Configure 'strong-password dictionary' and 'same-consecutive' to avoid weak password
								  d)	Check either of the following words exist in configuration file:
										-	Encrypt none
										-	Authentication null
										-	Encrypted null
										-	Encryption null
										-	Security-protocol noauth
										-	Encrypted noauth
								  e)	If 'strong-password max-length' not displayed in configuration, then pass this check.
										If 'strong-password max-length' displayed in configuration, but max-length value below 10, or not both configuration 'username-related-chk inverse' and 'strong-password date-check enable' commands, then fail this check.
								  f)	The validity period of an account can be configured.


								 Note: Either strong-password username-related-chk inverse or strong-password date-check enable has not been configured."
          solution    : "It is recommended to set the password to irrelevant to the username and date.

								 ZXR10# configure terminal
								 ZXR10 (config)# system-user
								 ZXR10 (config-system-user)# strong-password date-check enable"
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          reference   : "800-171|3.5.8,800-53|IA-5(1)(e),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(e),NESA|T5.2.3,NIAv2|AM22c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3"
        </report>
      </else>
    </if>

    <custom_item>
      type        : CONFIG_CHECK
      description : "1.2 Password Security Policy - e) Check for strong-password max-length"
      info        : "Strong passwords are supported to prevent passwords from being cracked. When a password is set, password complexity is detected by default. If a password does not meet the policy, a warning is required. A strong password mode should be provided. The password verification mechanism is as follows:

						  a)	The default password length shouldn't be below 8 characters.
						  b)	The password must include either three of 'number', 'capital', 'lowercase', 'special-character' or set the 'character-set-num' value to 3-4
						  c)	Configure 'strong-password dictionary' and 'same-consecutive' to avoid weak password
						  d)	Check either of the following words exist in configuration file:
								-	Encrypt none
								-	Authentication null
								-	Encrypted null
								-	Encryption null
								-	Security-protocol noauth
								-	Encrypted noauth
						  e)	If 'strong-password max-length' not displayed in configuration, then pass this check.
								If 'strong-password max-length' displayed in configuration, but max-length value below 10, or not both configuration 'username-related-chk inverse' and 'strong-password date-check enable' commands, then fail this check.
						  f)	The validity period of an account can be configured."
      solution    : "It is recommended to set the maximum password length to at least 10

						 ZXR10# configure terminal
						 ZXR10 (config)# system-user
						 ZXR10 (config-system-user)# strong-password max-length 64"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      item        : ".*strong-password max-length (10|[1-9][0-9]|1[0-1][0-9]|12[0-8])"
      section     : "system-user"
      reference   : "800-171|3.5.7,800-53|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
    </custom_item>
  </else>
</if>

<custom_item>
  type        : CONFIG_CHECK
  description : "1.2 Password Security Policy - f) The validity period of an account can be configured"
  info        : "Strong passwords are supported to prevent passwords from being cracked. When a password is set, password complexity is detected by default. If a password does not meet the policy, a warning is required. A strong password mode should be provided. The password verification mechanism is as follows:

				 a)	The default password length shouldn't be below 8 characters.
				 b)	The password must include either three of 'number', 'capital', 'lowercase', 'special-character' or set the 'character-set-num' value to 3-4
				 c)	Configure 'strong-password dictionary' and 'same-consecutive' to avoid weak password
				 d)	Check either of the following words exist in configuration file:
					-	Encrypt none
					-	Authentication null
					-	Encrypted null
					-	Encryption null
					-	Security-protocol noauth
					-	Encrypted noauth
				 e)	If 'strong-password max-length' not displayed in configuration, then pass this check.
				    If 'strong-password max-length' displayed in configuration, but max-length value below 10, or not both configuration 'username-related-chk inverse' and 'strong-password date-check enable' commands, then fail this check.
				 f)	The validity period of an account can be configured."
  solution    : "It is recommended to set the password validity period

				 ZXR10# configure terminal
				 ZXR10 (config)# system-user
				 ZXR10 (config-system-user)# user-name xxx
				 ZXR10 (config-system-user-username)# password-duration 360"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "[^\\r\\n]*password-duration ([1-9]|[1-9][0-9]|[1-2][0-9][0-9]|[3][0-5][0-9]|360)"
  section     : "system-user"
  reference   : "800-171|3.5.2,800-53|IA-5(1)(d),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(d),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
</custom_item>

# 7.3 (1.3)  SEC-SYS-GEN-030 Account Anti-riot Attack

<if>
#Check if user-authen-restriction has been configured

  <condition type:"AND">
    <custom_item>
      type        : CONFIG_CHECK
      description : "Check if user-authen-restriction is configured"
      item        : ".*user-authen-restriction"
    </custom_item>
  </condition>

  <then>
#If user-authen-restriction is configured, then check for fail-time and lock-minute

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CONFIG_CHECK
          description : "Check if user-authen-restriction is configured"
          item        : ".*user-authen-restriction.+fail-time.+lock-minute.+"
        </custom_item>
      </condition>

      <then>
#If both parameters are configured

        <custom_item>
          type        : CONFIG_CHECK
          description : "1.3 Account Anti-riot Attack"
          info        : "Some tools exist on the Internet, which specifically attack the management-plane protocol accounts of the system and frequently attempt accounts to attack devices so as to obtain accounts. Therefore, the system should be able to reject all remote login requests in a blocking manner when it is found that repeated remote login attempts fail for a certain number of consecutive times by monitoring the system account authentication. At this time, only IP requests from whitelisted users are allowed to be responded). This blocking can last for a period of time, so as to achieve the purpose of timely cutting off brute-force cracking attempts and protecting the CPU processing capability of the management plane."
          solution    : "Configuring the number of failures and locking time by running the following commands:

									 ZXR10 (config)#system-user
									 ZXR10 (config-system-user)#user-authen-restriction fail-time 3 lock-minute 2"
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          item        : ".*user-authen-restriction.+fail-time.+lock-minute.+"
          reference   : "800-171|3.1.8,800-53|AC-7.,CN-L3|8.1.4.1(b),ITSG-33|AC-7,NIAv2|AM24,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
        </custom_item>
      </then>

      <else>
#If either one of  the parameters is configured

        <report type:"FAILED">
          description : "1.3 Account Anti-riot Attack"
          info        : "Some tools exist on the Internet, which specifically attack the management-plane protocol accounts of the system and frequently attempt accounts to attack devices so as to obtain accounts. Therefore, the system should be able to reject all remote login requests in a blocking manner when it is found that repeated remote login attempts fail for a certain number of consecutive times by monitoring the system account authentication. At this time, only IP requests from whitelisted users are allowed to be responded). This blocking can last for a period of time, so as to achieve the purpose of timely cutting off brute-force cracking attempts and protecting the CPU processing capability of the management plane.

									 Note: Either fail-time or lock-minute not configured."
          solution    : "Configuring the number of failures and locking time by running the following commands:

									 ZXR10 (config)#system-user
									 ZXR10 (config-system-user)#user-authen-restriction fail-time 3 lock-minute 2"
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          reference   : "800-171|3.1.8,800-53|AC-7.,CN-L3|8.1.4.1(b),ITSG-33|AC-7,NIAv2|AM24,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
        </report>
      </else>
    </if>
  </then>

  <else>
#If user-authen-restriction is not configured

    <report type:"PASSED">
      description : "1.3 Account Anti-riot Attack"
      info        : "Some tools exist on the Internet, which specifically attack the management-plane protocol accounts of the system and frequently attempt accounts to attack devices so as to obtain accounts. Therefore, the system should be able to reject all remote login requests in a blocking manner when it is found that repeated remote login attempts fail for a certain number of consecutive times by monitoring the system account authentication. At this time, only IP requests from whitelisted users are allowed to be responded). This blocking can last for a period of time, so as to achieve the purpose of timely cutting off brute-force cracking attempts and protecting the CPU processing capability of the management plane.

							 Note: No user-authen-restriction is configured."
      solution    : "Configuring the number of failures and locking time by running the following commands:

							 ZXR10 (config)#system-user
							 ZXR10 (config-system-user)#user-authen-restriction fail-time 3 lock-minute 2"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-171|3.1.8,800-53|AC-7.,CN-L3|8.1.4.1(b),ITSG-33|AC-7,NIAv2|AM24,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
    </report>
  </else>
</if>

# 7.4 (1.4) SNMP Security

<if>
#Check if either snmp-server v1 or snmp-server v2c has been configured

  <condition type:"OR">
    <custom_item>
      type        : CONFIG_CHECK
      description : "Check if SNMP server v1 has been enabled"
      item        : "snmp-server version v1 enable"
    </custom_item>

    <custom_item>
      type        : CONFIG_CHECK
      description : "Check if SNMP server v2c has been enabled"
      item        : "snmp-server version v2c enable"
    </custom_item>
  </condition>

  <then>
#If either snmp-server v1 or snmp-server v2c has been enabled

    <report type:"FAILED">
      description : "1.4 SNMP Security - a) SNMP Community Security"
      info        : "Note: snmp-server version 1 and/or snmp-server version 2 have/has been configured."
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-171|3.5.10,800-53|IA-5(1)(c),CSF|PR.AC-1,ITSG-33|IA-5(1)(c),NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.1"
    </report>

    <report type:"FAILED">
      description : "1.4 SNMP Security - b) SNMP server"
      info        : "Note: snmp-server version 1 and/or snmp-server version 2 have/has been configured."
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-171|3.13.1,800-53|SC-7(11),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),NESA|T4.5.4,NIAv2|GS7c,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3"
    </report>

    <report type:"FAILED">
      description : "1.4 SNMP Security - c) SNMP Security Protection Function"
      info        : "Note: snmp-server version 1 and/or snmp-server version 2 have/has been configured."
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-53|SC-5.,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1"
    </report>
  </then>

  <else>
    <if>
#Check for any presence of snmp-server v1, snmp-server v2c and snmp-server v3

      <condition type:"AND">
        <custom_item>
          type        : CONFIG_CHECK_NOT
          description : "Check if SNMP server v1 has been enabled"
          item        : "snmp-server version v1 enable"
        </custom_item>

        <custom_item>
          type        : CONFIG_CHECK_NOT
          description : "Check if SNMP server v2c has been enabled"
          item        : "snmp-server version v2c enable"
        </custom_item>

        <custom_item>
          type        : CONFIG_CHECK_NOT
          description : "Check if SNMP server v3 has been enabled"
          item        : "snmp-server version v3 enable"
        </custom_item>
      </condition>

      <then>
#If none of the version is enabled

        <report type:"PASSED">
          description : "1.4 SNMP Security - a) SNMP Community Security"
          info        : "Note: No snmp-server configuration has been detected."
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          reference   : "800-171|3.5.10,800-53|IA-5(1)(c),CSF|PR.AC-1,ITSG-33|IA-5(1)(c),NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.1"
        </report>

        <report type:"PASSED">
          description : "1.4 SNMP Security - b) SNMP server"
          info        : "Note: No snmp-server configuration has been detected."
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          reference   : "800-171|3.13.1,800-53|SC-7(11),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),NESA|T4.5.4,NIAv2|GS7c,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3"
        </report>

        <report type:"PASSED">
          description : "1.4 SNMP Security - c) SNMP Security Protection Function"
          info        : "Note: No snmp-server configuration has been detected."
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          reference   : "800-53|SC-5.,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1"
        </report>
      </then>

      <else>
        <custom_item>
          type        : CONFIG_CHECK
          description : "1.4 SNMP Security - a) SNMP Community Security"
          info        : "Modify the default Community password of SNMP to prevent hackers from using the same Community to obtain sensitive device information and attack ROSNG series products."
          solution    : "Configuring VIEW-based read/write access capability

								ZXR10#config terminal

								Enter configuration commands, one per line. End with CNTL/Z.
								ZXR10 (config)# snmp-server community my_readonly view AllView ro
								ZXR10 (config)# snmp-server community my_readwrite view AllView rw"
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          item        : "^snmp-server community encrypted .{60}.* view AllView (ro|rw)"
          reference   : "800-171|3.5.10,800-53|IA-5(1)(c),CSF|PR.AC-1,ITSG-33|IA-5(1)(c),NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.1"
        </custom_item>

        <custom_item>
          type        : CONFIG_CHECK
          description : "1.4 SNMP Security - b) SNMP server"
          info        : "Specify SNMP server, restrict the management address, prevent untrusted networks from connecting to snmp, and reduce the possibility of ROSNG products being attacked."
          solution    : "Configure the snmp Server:

								ZXR10#config terminal

								Enter configuration commands, one per line. End with CNTL/Z.
								ZXR10 (config)## ipv4-access-list snmp_acl
								ZXR10 (config-ipv4-acl)#rule 1 permit 14.2.6.60 0.0.0.0
								ZXR10 (config-ipv4-acl)#exit
								ZXR10 (config)# snmp-server access-list ipv4 snmp_acl"
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          item        : "^snmp-server access-list ipv(4|6) .+"
          reference   : "800-171|3.13.1,800-53|SC-7(11),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),NESA|T4.5.4,NIAv2|GS7c,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3"
        </custom_item>

        <custom_item>
          type        : CONFIG_CHECK
          description : "1.4 SNMP Security - c) SNMP Security Protection Function"
          info        : "Enable the SNMP security function to restrict the number of times of management address, prevent hackers from malicious attacks, and improve the security of ROSNG series products."
          solution    : "Enable security protection:
								ZXR10 (config)#snmp-server security block 200  15 100 when 10 60"
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          item        : "^snmp-server security block .+"
          reference   : "800-53|SC-5.,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1"
        </custom_item>
      </else>
    </if>
  </else>
</if>

# 7.5 (1.5) FTP/SFTP Access Authorization

<if>
  <condition type:"OR">
    <custom_item>
      type        : CONFIG_CHECK
      description : "Check for if ftp-server is enabled"
      item        : "ftp-server enable"
    </custom_item>

    <custom_item>
      type        : CONFIG_CHECK
      description : "Check for if sftp-server is enabled"
      item        : "sftp-server enable"
    </custom_item>
  </condition>

  <then>
    <report type:"FAILED">
      description : "1.5 FTP/SFTP Access Authorization"
      info        : "Set ftp upload and download file permission control to facilitate the separate control of different users and different permissions, and strengthen the security of ROSNG series products.

							Note: Either ftp-server or ftp-secure-server has been enabled."
      solution    : "Under authorization-template, configure the corresponding ftp permissions, such as ZXR10 (config-system-user-author-temp) #ftp top-directory/datadisk0/read-only"
      reference   : "800-53|CM-7b."
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
    </report>
  </then>

  <else>
    <if>
      <condition type:"AND">
        <custom_item>
          type        : CONFIG_CHECK
          description : "Check if SSH server is enabled"
          item        : "^ssh server enable"
        </custom_item>

        <custom_item>
          type        : CONFIG_CHECK
          description : "Check if sftp top-directory has been configured"
          item        : ".*sftp top-directory"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : CONFIG_CHECK
          description : "1.5 FTP/SFTP Access Authorization - sftp top-directory"
          info        : "Set ftp upload and download file permission control to facilitate the separate control of different users and different permissions, and strengthen the security of ROSNG series products."
          solution    : "Under authorization-template, configure the corresponding ftp permissions, such as:

								ZXR10 (config-system-user-author-temp) #sftp top-directory /datadisk0/ read-only"
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          item        : ".*sftp top-directory"
          reference   : "800-171|3.4.2,800-53|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6b.,NESA|T3.2.1,SWIFT-CSCv1|2.3"
        </custom_item>

        <custom_item>
          type        : CONFIG_CHECK
          description : "1.5 FTP/SFTP Access Authorization - login-type-allowed"
          info        : "Set ftp upload and download file permission control to facilitate the separate control of different users and different permissions, and strengthen the security of ROSNG series products."
          solution    : "Close the ftp access channel, for example:

							    ZXR10 (config)# no ftp-server enable
							    ZXR10 (config-system-user-author-temp)# login-type-allowed ssh."
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          item        : ".*login-type-allowed ssh"
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,NIAv2|SS15a,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
        </custom_item>
      </then>

      <else>
        <report type:"FAILED">
          description : "1.5 FTP/SFTP Access Authorization - sftp top-directory"
          info        : "Set ftp upload and download file permission control to facilitate the separate control of different users and different permissions, and strengthen the security of ROSNG series products.

									Noted: Either SSH server or sftp top-directory has not been configured."
          solution    : "Under authorization-template, configure the corresponding ftp permissions, such as:

								    ZXR10 (config-system-user-author-temp) #sftp top-directory /datadisk0/ read-only"
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          reference   : "800-171|3.4.2,800-53|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6b.,NESA|T3.2.1,SWIFT-CSCv1|2.3"
        </report>

        <report type:"FAILED">
          description : "1.5 FTP/SFTP Access Authorization - login-type-allowed"
          info        : "Set ftp upload and download file permission control to facilitate the separate control of different users and different permissions, and strengthen the security of ROSNG series products.

									Noted: Either SSH server or sftp top-directory has not been configured."
          solution    : "Close the ftp access channel, for example:

									ZXR10 (config)# no ftp-server enable
									ZXR10 (config-system-user-author-temp)# login-type-allowed ssh."
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,NIAv2|SS15a,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
        </report>
      </else>
    </if>
  </else>
</if>

# 7.6 (1.6) Support Web Access Security

<if>
  <condition type:"AND">
    <custom_item>
      type        : CONFIG_CHECK
      description : "Check if ciphersuite is configured"
      item        : ".*ciphersuite .+"
    </custom_item>

    <custom_item>
      type        : CONFIG_CHECK
      description : "Check if web secure-server ssl-context is configured"
      item        : "web secure-server ssl-context .+"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type        : CONFIG_CHECK_NOT
      description : "1.6 Support Web Access Security - a) ciphersuite"
      info        : "Provide secure HTTPS webpage access between the local device and users, and a secure transmission channel for users' Web management devices. Avoid interception of intermediate data. If the login page needs to be displayed in the WEB, the login username and password can be used to access the page, meeting the scanning requirements of security tools such as nessus, webinspect, and AWE."
      solution    : "1.	use HTTPS instead of HTTP, SSL must bound PKI profile, the bounded PKI profile needs to import a legal and valid CA certificate
						 2.	TLS(SSL) version is recommended to be greater than TLS v1.2, at least not less than TLS v1.1.
						 3.	TLS algorithm does not contain insecure algorithms, which include: CBC, SHA1, MD5"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      item        : ".*ciphersuite.+((-md5 |-sha |-cbc-sha )|(-md5$|-sha$|-cbc-sha$))"
      reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
    </custom_item>

    <custom_item>
      type        : CONFIG_CHECK
      description : "1.6 Support Web Access Security - b) ssl-context field"
      info        : "Provide secure HTTPS webpage access between the local device and users, and a secure transmission channel for users' Web management devices. Avoid interception of intermediate data. If the login page needs to be displayed in the WEB, the login username and password can be used to access the page, meeting the scanning requirements of security tools such as nessus, webinspect, and AWE."
      solution    : "1.	use HTTPS instead of HTTP, SSL must bound PKI profile, the bounded PKI profile needs to import a legal and valid CA certificate
						 2.	TLS(SSL) version is recommended to be greater than TLS v1.2, at least not less than TLS v1.1.
						 3.	TLS algorithm does not contain insecure algorithms, which include: CBC, SHA1, MD5"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      item        : "web secure-server ssl-context .+"
      reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CONFIG_CHECK_NOT
          description : "Check if version is configured"
          item        : ".*version .+"
        </custom_item>
      </condition>

      <then>
        <report type:"WARNING">
          description : "1.6 Support Web Access Security - c) version"
          info        : "Version is not configured.

         NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
        </report>
      </then>

      <else>
        <if>
          <condition type:"AND">
            <custom_item>
              type        : CONFIG_CHECK_NOT
              description : "Check if SSL version is not of SSL2.0, SSL3.0, TLS1.0"
              item        : ".*version (ssl2.0|ssl3.0|tls1.0)"
            </custom_item>
          </condition>

          <then>
            <if>
              <condition type:"AND">
                <custom_item>
                  type        : CONFIG_CHECK
                  description : "Check if SSL version is not of SSL2.0, SSL3.0, TLS1.0"
                  item        : ".*version tls1.1"
                </custom_item>
              </condition>

              <then>
                <report type:"WARNING">
                  description : "1.6 Support Web Access Security - c) version"
                  info        : "Provide secure HTTPS webpage access between the local device and users, and a secure transmission channel for users' Web management devices. Avoid interception of intermediate data. If the login page needs to be displayed in the WEB, the login username and password can be used to access the page, meeting the scanning requirements of security tools such as nessus, webinspect, and AWE.

									 Note: TLS1.1 has been configured.

                   NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
                  solution    : "1.	use HTTPS instead of HTTP, SSL must bound PKI profile, the bounded PKI profile needs to import a legal and valid CA certificate
									 2.	TLS(SSL) version is recommended to be greater than TLS v1.2, at least not less than TLS v1.1.
									 3.	TLS algorithm does not contain insecure algorithms, which include: CBC, SHA1, MD5"
                  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
                  reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
                </report>
              </then>

              <else>
                <custom_item>
                  type        : CONFIG_CHECK
                  description : "1.6 Support Web Access Security - c) version"
                  info        : "Provide secure HTTPS webpage access between the local device and users, and a secure transmission channel for users' Web management devices. Avoid interception of intermediate data. If the login page needs to be displayed in the WEB, the login username and password can be used to access the page, meeting the scanning requirements of security tools such as nessus, webinspect, and AWE."
                  solution    : "1.	use HTTPS instead of HTTP, SSL must bound PKI profile, the bounded PKI profile needs to import a legal and valid CA certificate
								     2.	TLS(SSL) version is recommended to be greater than TLS v1.2, at least not less than TLS v1.1.
								     3.	TLS algorithm does not contain insecure algorithms, which include: CBC, SHA1, MD5"
                  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
                  item        : ".*version tls(1.2|1.3) ?(tls1.3)?"
                  reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
                </custom_item>
              </else>
            </if>
          </then>

          <else>
            <report type:"FAILED">
              description : "1.6 Support Web Access Security - c) version"
              info        : "Provide secure HTTPS webpage access between the local device and users, and a secure transmission channel for users' Web management devices. Avoid interception of intermediate data. If the login page needs to be displayed in the WEB, the login username and password can be used to access the page, meeting the scanning requirements of security tools such as nessus, webinspect, and AWE.

								 Note: Either SSL2.0, SSL3.0 or TLS1.0 has been configured."
              solution    : "1.	use HTTPS instead of HTTP, SSL must bound PKI profile, the bounded PKI profile needs to import a legal and valid CA certificate
								 2.	TLS(SSL) version is recommended to be greater than TLS v1.2, at least not less than TLS v1.1.
								 3.	TLS algorithm does not contain insecure algorithms, which include: CBC, SHA1, MD5"
              see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
              reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
            </report>
          </else>
        </if>
      </else>
    </if>
  </then>

  <else>
    <report type:"PASSED">
      description : "1.6 Support Web Access Security - a) ciphersuite"
      info        : "Provide secure HTTPS webpage access between the local device and users, and a secure transmission channel for users' Web management devices. Avoid interception of intermediate data. If the login page needs to be displayed in the WEB, the login username and password can be used to access the page, meeting the scanning requirements of security tools such as nessus, webinspect, and AWE.

						 Either ciphersuite or web secure-server ssl-context has not been configured.

						 Note: Check on ciphersuite was not carried out."
      solution    : "1.	use HTTPS instead of HTTP, SSL must bound PKI profile, the bounded PKI profile needs to import a legal and valid CA certificate
						 2.	TLS(SSL) version is recommended to be greater than TLS v1.2, at least not less than TLS v1.1.
						 3.	TLS algorithm does not contain insecure algorithms, which include: CBC, SHA1, MD5"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
    </report>

    <report type:"PASSED">
      description : "1.6 Support Web Access Security - b) ssl-context field"
      info        : "Provide secure HTTPS webpage access between the local device and users, and a secure transmission channel for users' Web management devices. Avoid interception of intermediate data. If the login page needs to be displayed in the WEB, the login username and password can be used to access the page, meeting the scanning requirements of security tools such as nessus, webinspect, and AWE.

						 Either ciphersuite or web secure-server ssl-context has not been configured.

						 Note: Check on ssl-context was not carried out."
      solution    : "1.	use HTTPS instead of HTTP, SSL must bound PKI profile, the bounded PKI profile needs to import a legal and valid CA certificate
						 2.	TLS(SSL) version is recommended to be greater than TLS v1.2, at least not less than TLS v1.1.
						 3.	TLS algorithm does not contain insecure algorithms, which include: CBC, SHA1, MD5"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
    </report>

    <report type:"PASSED">
      description : "1.6 Support Web Access Security - c) version"
      info        : "Provide secure HTTPS webpage access between the local device and users, and a secure transmission channel for users' Web management devices. Avoid interception of intermediate data. If the login page needs to be displayed in the WEB, the login username and password can be used to access the page, meeting the scanning requirements of security tools such as nessus, webinspect, and AWE.

							Either ciphersuite or web secure-server ssl-context has not been configured.

			                Note: Check on version was not carried out."
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
    </report>
  </else>
</if>

# 7.7 (1.7) Log Auditing

<custom_item>
  type        : CONFIG_CHECK
  description : "1.7 Log Auditing"
  info        : "The system can generate logs for key events to track activities that occur and conduct security audits. Some typical events are listed below:
					1) Modify the log function configuration
					2) Log in to and out of the system
					3) Add and delete accounts and modify system privileges
					4) Enable or disable the system and key services
					5) Modify system time and configuration files
					6) Modify the configuration file"
  info        : "Generate logs for auditable events and record at least the following information in each audit record:
					1) Date and time when the event occurs
					2) Event type
					3) Administrator identity
					4) Event Result (succeed or fail)"
  solution    : "Configure the log type and permission of the user authorization template:

					ZXR10(config-system-user)#authorization-template 1
				    ZXR10(config-system-user-author-temp)#logfile-allowed cmd-log read-only"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : ".*logfile-allowed .+"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
</custom_item>

# 7.8 (1.8) SSH Strong Algorithm

<custom_item>
  type        : CONFIG_CHECK
  description : "1.8 SSH Strong Algorithm - a) Disable encryption none"
  info        : "Disable the weak algorithm of the ssh to interact with the client through the strong algorithm in the ssh connection, and provide security protection for the ROSNG series products."
  solution    : "Disable the ssh weak algorithm:

					ZXR10 (config)#ssh server encryption none disable"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "ssh server encryption none disable"
  reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "1.8 SSH Strong Algorithm - b) Disable encryption 3des-cbc"
  info        : "Disable the weak algorithm of the ssh to interact with the client through the strong algorithm in the ssh connection, and provide security protection for the ROSNG series products."
  solution    : "Disable the ssh weak algorithm:

					ZXR10 (config)#ssh server encryption 3des-cbc disable"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "ssh server encryption 3des-cbc disable"
  reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "1.8 SSH Strong Algorithm - c) Disable encryption aes128-cbc"
  info        : "Disable the weak algorithm of the ssh to interact with the client through the strong algorithm in the ssh connection, and provide security protection for the ROSNG series products."
  solution    : "Disable the ssh weak algorithm:

					ZXR10 (config)#ssh server encryption aes128-cbc disable"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "ssh server encryption aes128-cbc disable"
  reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "1.8 SSH Strong Algorithm - d) Disable encryption aes192-cbc"
  info        : "Disable the weak algorithm of the ssh to interact with the client through the strong algorithm in the ssh connection, and provide security protection for the ROSNG series products."
  solution    : "Disable the ssh weak algorithm:

					ZXR10 (config)#ssh server encryption aes192-cbc disable"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "ssh server encryption aes192-cbc disable"
  reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "1.8 SSH Strong Algorithm - e) Disable encryption aes256-cbc"
  info        : "Disable the weak algorithm of the ssh to interact with the client through the strong algorithm in the ssh connection, and provide security protection for the ROSNG series products."
  solution    : "Disable the ssh weak algorithm:

					ZXR10 (config)#ssh server encryption aes256-cbc disable"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "ssh server encryption aes256-cbc disable"
  reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "1.8 SSH Strong Algorithm - f) Disable encryption blowfish-cbc"
  info        : "Disable the weak algorithm of the ssh to interact with the client through the strong algorithm in the ssh connection, and provide security protection for the ROSNG series products."
  solution    : "Disable the ssh weak algorithm:

					ZXR10 (config)#ssh server encryption blowfish-cbc disable"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "ssh server encryption blowfish-cbc disable"
  reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "1.8 SSH Strong Algorithm - g) Disable hmac md5"
  info        : "Disable the weak algorithm of the ssh to interact with the client through the strong algorithm in the ssh connection, and provide security protection for the ROSNG series products."
  solution    : "Disable the ssh weak algorithm:

					ZXR10 (config)#ssh server hmac md5 disable"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "ssh server hmac md5 disable"
  reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "1.8 SSH Strong Algorithm - h) Disable hmac none"
  info        : "Disable the weak algorithm of the ssh to interact with the client through the strong algorithm in the ssh connection, and provide security protection for the ROSNG series products."
  solution    : "Disable the ssh weak algorithm:

					ZXR10 (config)#ssh server hmac none disable"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "ssh server hmac none disable"
  reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "1.8 SSH Strong Algorithm - i) Disable diffie-hellman group-exchange-sha1"
  info        : "Disable the weak algorithm of the ssh to interact with the client through the strong algorithm in the ssh connection, and provide security protection for the ROSNG series products."
  solution    : "Disable the ssh weak algorithm:

					ZXR10 (config)#ssh server diffie-hellman group-exchange-sha1 disable"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "ssh server diffie-hellman group-exchange-sha1 disable"
  reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "1.8 SSH Strong Algorithm - j) Disable diffie-hellman group1-sha1"
  info        : "Disable the weak algorithm of the ssh to interact with the client through the strong algorithm in the ssh connection, and provide security protection for the ROSNG series products."
  solution    : "Disable the ssh weak algorithm:

					ZXR10 (config)#ssh server diffie-hellman group1-sha1 disable"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "ssh server diffie-hellman group1-sha1 disable"
  reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "1.8 SSH Strong Algorithm - k) Disable hmac sha1"
  info        : "Disable the weak algorithm of the ssh to interact with the client through the strong algorithm in the ssh connection, and provide security protection for the ROSNG series products."
  solution    : "Disable the ssh weak algorithm:

					ZXR10 (config)#ssh server diffie-hellman group1-sha1 disable"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "ssh server hmac sha1 disable"
  reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
</custom_item>

# 7.9 (1.9) SSL Strong Algorithm

<if>
  <condition type:"AND">
    <custom_item>
      type        : CONFIG_CHECK
      description : "Check if ssl version has been configured"
      item        : ".*version .+"
      section     : "ssl"
    </custom_item>
  </condition>

  <then>
    <if>
      <condition type:"AND">
        <custom_item>
          type        : CONFIG_CHECK_NOT
          description : "Check if SSL version is not of SSL2.0, SSL3.0, TLS1.0"
          item        : ".*version (ssl2.0|ssl3.0|tls1.0)"
          section     : "ssl"
        </custom_item>
      </condition>

      <then>
        <if>
          <condition type:"AND">
            <custom_item>
              type        : CONFIG_CHECK
              description : "Check if SSL version is not of SSL2.0, SSL3.0, TLS1.0"
              item        : ".*version tls1.1"
              section     : "ssl"
            </custom_item>
          </condition>

          <then>
            <report type:"WARNING">
              description : "1.9 SSL Strong Algorithm - a) Version"
              info        : "There is a security risk to the ssl lower versions of the equipment. The device can be configured to support higher versions and algorithms only to reduce the connection risk of the ROSNG series products.

									 Note: TLS1.1 has been configured

                   NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
              solution    : "1.	SSL must bound PKI profile, the bounded PKI profile needs to import a legal and valid CA certificate
									2.	TLS(SSL) version is recommended to be greater than TLS v1.2, at least not less than TLS v1.1.
									3.	TLS algorithm does not contain insecure algorithms, which include: CBC, SHA1, MD5
									4.	Disable renegotiate"
              see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
              reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
            </report>
          </then>

          <else>
            <custom_item>
              type        : CONFIG_CHECK
              description : "1.9 SSL Strong Algorithm - a) Version"
              info        : "There is a security risk to the ssl lower versions of the equipment. The device can be configured to support higher versions and algorithms only to reduce the connection risk of the ROSNG series products."
              solution    : "1.	SSL must bound PKI profile, the bounded PKI profile needs to import a legal and valid CA certificate
									2.	TLS(SSL) version is recommended to be greater than TLS v1.2, at least not less than TLS v1.1.
									3.	TLS algorithm does not contain insecure algorithms, which include: CBC, SHA1, MD5
									4.	Disable renegotiate"
              see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
              item        : "version tls(1.2|1.3) ?(tls1.3)?"
              section     : "ssl"
              reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
            </custom_item>
          </else>
        </if>
      </then>

      <else>
        <report type:"FAILED">
          description : "1.9 SSL Strong Algorithm - a) Version"
          info        : "There is a security risk to the ssl lower versions of the equipment. The device can be configured to support higher versions and algorithms only to reduce the connection risk of the ROSNG series products.

								 Note: Either SSL2.0, SSL3.0 or TLS1.0 has been configured"
          solution    : "1.	SSL must bound PKI profile, the bounded PKI profile needs to import a legal and valid CA certificate
							    2.	TLS(SSL) version is recommended to be greater than TLS v1.2, at least not less than TLS v1.1.
							    3.	TLS algorithm does not contain insecure algorithms, which include: CBC, SHA1, MD5
							    4.	Disable renegotiate"
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
        </report>
      </else>
    </if>

    <custom_item>
      type        : CONFIG_CHECK_NOT
      description : "1.9 SSL Strong Algorithm - b) ciphersuite"
      info        : "There is a security risk to the ssl lower versions of the equipment. The device can be configured to support higher versions and algorithms only to reduce the connection risk of the ROSNG series products."
      solution    : "1.	SSL must bound PKI profile, the bounded PKI profile needs to import a legal and valid CA certificate
						2.	TLS(SSL) version is recommended to be greater than TLS v1.2, at least not less than TLS v1.1.
						3.	TLS algorithm does not contain insecure algorithms, which include: CBC, SHA1, MD5
						4.	Disable renegotiate"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      item        : ".*ciphersuite.+((-md5 |-sha1 |-cbc-sha )|(-md5$|-sha1$|-cbc-sha$))"
      section     : "ssl"
      reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
    </custom_item>

    <custom_item>
      type        : CONFIG_CHECK
      description : "1.9 SSL Strong Algorithm - c) pki-profile"
      info        : "There is a security risk to the ssl lower versions of the equipment. The device can be configured to support higher versions and algorithms only to reduce the connection risk of the ROSNG series products."
      solution    : "1.	SSL must bound PKI profile, the bounded PKI profile needs to import a legal and valid CA certificate
						2.	TLS(SSL) version is recommended to be greater than TLS v1.2, at least not less than TLS v1.1.
						3.	TLS algorithm does not contain insecure algorithms, which include: CBC, SHA1, MD5
						4.	Disable renegotiate"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      item        : "pki-profile .+"
      section     : "ssl"
      reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
    </custom_item>

    <custom_item>
      type        : CONFIG_CHECK
      description : "1.9 SSL Strong Algorithm - d) renegotiate"
      info        : "There is a security risk to the ssl lower versions of the equipment. The device can be configured to support higher versions and algorithms only to reduce the connection risk of the ROSNG series products."
      solution    : "1.	SSL must bound PKI profile, the bounded PKI profile needs to import a legal and valid CA certificate
						2.	TLS(SSL) version is recommended to be greater than TLS v1.2, at least not less than TLS v1.1.
						3.	TLS algorithm does not contain insecure algorithms, which include: CBC, SHA1, MD5
						4.	Disable renegotiate"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      item        : "renegotiate disable"
      section     : "ssl"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
    </custom_item>
  </then>

  <else>
    <report type:"FAILED">
      description : "1.9 SSL Strong Algorithm - a) Version"
      info        : "There is a security risk to the ssl lower versions of the equipment. The device can be configured to support higher versions and algorithms only to reduce the connection risk of the ROSNG series products.

							Note: No check has been carried out since version is not observed under SSL configuration."
      solution    : "1.	SSL must bound PKI profile, the bounded PKI profile needs to import a legal and valid CA certificate
							2.	TLS(SSL) version is recommended to be greater than TLS v1.2, at least not less than TLS v1.1.
							3.	TLS algorithm does not contain insecure algorithms, which include: CBC, SHA1, MD5
							4.	Disable renegotiate"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
    </report>

    <report type:"FAILED">
      description : "1.9 SSL Strong Algorithm - b) ciphersuite"
      info        : "There is a security risk to the ssl lower versions of the equipment. The device can be configured to support higher versions and algorithms only to reduce the connection risk of the ROSNG series products.

							Note: No check has been carried out since version is not observed under SSL configuration."
      solution    : "1.	SSL must bound PKI profile, the bounded PKI profile needs to import a legal and valid CA certificate
							2.	TLS(SSL) version is recommended to be greater than TLS v1.2, at least not less than TLS v1.1.
							3.	TLS algorithm does not contain insecure algorithms, which include: CBC, SHA1, MD5
							4.	Disable renegotiate"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
    </report>

    <report type:"FAILED">
      description : "1.9 SSL Strong Algorithm - c) pki-profile"
      info        : "There is a security risk to the ssl lower versions of the equipment. The device can be configured to support higher versions and algorithms only to reduce the connection risk of the ROSNG series products.

							Note: No check has been carried out since version is not observed under SSL configuration."
      solution    : "1.	SSL must bound PKI profile, the bounded PKI profile needs to import a legal and valid CA certificate
							2.	TLS(SSL) version is recommended to be greater than TLS v1.2, at least not less than TLS v1.1.
							3.	TLS algorithm does not contain insecure algorithms, which include: CBC, SHA1, MD5
							4.	Disable renegotiate"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-171|3.13.11,800-53|SC-13.,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
    </report>

    <report type:"FAILED">
      description : "1.9 SSL Strong Algorithm - d) renegotiate"
      info        : "There is a security risk to the ssl lower versions of the equipment. The device can be configured to support higher versions and algorithms only to reduce the connection risk of the ROSNG series products.

							Note: No check has been carried out since version is not observed under SSL configuration."
      solution    : "1.	SSL must bound PKI profile, the bounded PKI profile needs to import a legal and valid CA certificate
							2.	TLS(SSL) version is recommended to be greater than TLS v1.2, at least not less than TLS v1.1.
							3.	TLS algorithm does not contain insecure algorithms, which include: CBC, SHA1, MD5
							4.	Disable renegotiate"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
    </report>
  </else>
</if>

# 8 Control Layer Security Requirements
# 8.1 (2.1) Protection Policy for the CPS Control Engine

<custom_item>
  type        : CONFIG_CHECK
  description : "2.1 Protection Policy for the CPS Control Engine"
  info        : "The system can generate logs for key events to track activities that occur and conduct security audits. Some typical events are listed below:

					1) Modify the log function configuration.
					2) Log in to and out of the system.
					3) Add and delete accounts and modify system privileges.
					4) Enable or disable the system and key services.
					5) Modify system time and configuration files.
					6) Modify the configuration file."
  info        : "Generate logs for auditable events and record at least the following information in each audit record:
					1) Date and time when the event occurs
					2) Event type
					3) Administrator identity
					4) Event Result (succeed or fail)"
  solution    : "ZXR10 (config)#control-plane-security

					ZXR10 (config-cps)#defend-policy"
  solution    : "ZXR10 (config-cps-policy)#ipv4-white-list match ipv4-access-list white"
  solution    : "ZXR10 (config-cps-policy)#ipv4-black-list match ipv4-access-list black"
  solution    : "ZXR10 (config-cps-policy)#ipv6-black-list match ipv6-access-list whitev6"
  solution    : "ZXR10 (config-cps-policy)#ipv6-black-list match ipv6-access-list blackv6"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  context     : "^control-plane-security"
  item        : "ipv(4|6)-(white|black)-list match ipv(4|6)-access-list .+"
  reference   : "800-171|3.13.1,800-53|SC-7(11),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),NESA|T4.5.4,NIAv2|GS7c,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3"
</custom_item>

# 8.2 (2.2) NTP Security Protection

<custom_item>
  type        : CONFIG_CHECK
  description : "2.2 NTP Security Protection - a) Enable NTP"
  info        : "From the perspective of security, the equipment should support the NTP clock synchronization protocol to ensure that all the equipment in the network have the same clock and that the log timestamps are correct. ROSNG supports the NTP protocol.

				    In addition, in order to ensure the security of the NTP protocol, it supports ACL filtering to limit NTP packets that enter the IP network device from the external network, and allows MD5 authentication on NTP sessions."
  solution    : "It is recommended to config NTP for clock synchronization.

					ZXR10(config)#ntp enable"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "^ntp enable"
  reference   : "800-171|3.3.7,800-53|AU-8.,CN-L3|8.1.4.3(b),CSF|PR.PT-1,ITSG-33|AU-8,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,TBA-FIISB|37.4"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "2.2 NTP Security Protection - b) NTP access-group"
  info        : "From the perspective of security, the equipment should support the NTP clock synchronization protocol to ensure that all the equipment in the network have the same clock and that the log timestamps are correct. ROSNG supports the NTP protocol.

				    In addition, in order to ensure the security of the NTP protocol, it supports ACL filtering to limit NTP packets that enter the IP network device from the external network, and allows MD5 authentication on NTP sessions."
  solution    : "It is recommended to config NTP for clock synchronization, and also set the ipv4-access-list filtering rules.

					ZXR10#config terminal
					ZXR10 (config)#ntp access-group ipv4-access-list xxx"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "(^ntp access-group ipv(4|6)-access-list .+|^ntp access-group ipv(4|6)-server-only .+)"
  reference   : "800-171|3.13.1,800-53|SC-7(11),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),NESA|T4.5.4,NIAv2|GS7c,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "2.2 NTP Security Protection - c) NTP Auth-key encrypted"
  info        : "From the perspective of security, the equipment should support the NTP clock synchronization protocol to ensure that all the equipment in the network have the same clock and that the log timestamps are correct. ROSNG supports the NTP protocol.

				    In addition, in order to ensure the security of the NTP protocol, it supports ACL filtering to limit NTP packets that enter the IP network device from the external network, and allows MD5 authentication on NTP sessions."
  solution    : "It is recommended to config NTP for clock synchronization, and also set the ipv4-access-list filtering rules and authentication key.

					ZXR10#config terminal
					ZXR10 (config)#ntp authenticate
					ZXR10 (config)#ntp authentication-key 1 md5 clear xxxxxxx
					ZXR10 (config)#ntp trusted-key 1"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "ntp authentication-key .+ md5 encrypted .+"
  reference   : "800-171|3.3.7,800-53|AU-8(1),CN-L3|8.1.4.3(b),CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,QCSC-v1|8.2.1,QCSC-v1|13.2,TBA-FIISB|37.4"
</custom_item>

# 8.3 (2.3) Disable the Proxy ARP Function

<if>
  <condition type:"OR">
    <custom_item>
      type        : CONFIG_CHECK
      description : "Check if inter-vlan-proxy has been configured"
      context     : "^arp"
      item        : ".*inter-vlan-proxy"
    </custom_item>

    <custom_item>
      type        : CONFIG_CHECK
      description : "Check if local-proxy-arp has been configured"
      context     : "^arp"
      item        : ".*local-proxy-arp"
    </custom_item>

    <custom_item>
      type        : CONFIG_CHECK
      description : "Check if proxy has been configured"
      context     : "^arp"
      item        : ".*proxy"
    </custom_item>

    <custom_item>
      type        : CONFIG_CHECK
      description : "Check if proxy local has been configured"
      context     : "^arp"
      item        : ".*proxy local"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type        : CONFIG_CHECK_NOT
      description : "2.3 Disable the Proxy ARP Function - a) No proxy"
      info        : "PROXY ARP should be used in networks where the host is not configured with default gateway or there is no routing policy.

						PROXY ARP has negative effects:
						1. ARP traffic on one network segment is increased
						2. The host needs a larger ARP table to process the mapping from IP address to MAC address
						3. Security problems are available, such as ARP spoofing (spoofing)
						4. Does not work for a network that does not use ARP to parse addresses
						5. Network topology cannot be summarized and promoted"
      solution    : "Disable the functions related to Proxy ARP:

						ZXR10 (config)#arp
						ZXR10 (config-arp)#interface fei-0/1/1/13
						ZXR10 (config-arp-if)#no proxy
						ZXR10 (config-arp-if)#no inter-vlan-proxy
						ZXR10 (config-arp-if)#no proxy local
						ZXR10 (config-arp-if)#no local-proxy-arp"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      context     : "^arp"
      item        : ".*proxy"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
    </custom_item>

    <custom_item>
      type        : CONFIG_CHECK_NOT
      description : "2.3 Disable the Proxy ARP Function - b) No inter-vlan-proxy"
      info        : "PROXY ARP should be used in networks where the host is not configured with default gateway or there is no routing policy.

						PROXY ARP has negative effects:
						1. ARP traffic on one network segment is increased
						2. The host needs a larger ARP table to process the mapping from IP address to MAC address
						3. Security problems are available, such as ARP spoofing (spoofing)
						4. Does not work for a network that does not use ARP to parse addresses
						5. Network topology cannot be summarized and promoted"
      solution    : "Disable the functions related to Proxy ARP:

						ZXR10 (config)#arp
						ZXR10 (config-arp)#interface fei-0/1/1/13
						ZXR10 (config-arp-if)#no proxy
						ZXR10 (config-arp-if)#no inter-vlan-proxy
						ZXR10 (config-arp-if)#no proxy local
						ZXR10 (config-arp-if)#no local-proxy-arp"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      context     : "^arp"
      item        : ".*inter-vlan-proxy"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
    </custom_item>

    <custom_item>
      type        : CONFIG_CHECK_NOT
      description : "2.3 Disable the Proxy ARP Function - c) No proxy local"
      info        : "PROXY ARP should be used in networks where the host is not configured with default gateway or there is no routing policy.

						PROXY ARP has negative effects:
						1. ARP traffic on one network segment is increased
						2. The host needs a larger ARP table to process the mapping from IP address to MAC address
						3. Security problems are available, such as ARP spoofing (spoofing)
						4. Does not work for a network that does not use ARP to parse addresses
						5. Network topology cannot be summarized and promoted"
      solution    : "Disable the functions related to Proxy ARP:

						ZXR10 (config)#arp
						ZXR10 (config-arp)#interface fei-0/1/1/13
						ZXR10 (config-arp-if)#no proxy
						ZXR10 (config-arp-if)#no inter-vlan-proxy
						ZXR10 (config-arp-if)#no proxy local
						ZXR10 (config-arp-if)#no local-proxy-arp"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      context     : "^arp"
      item        : ".*proxy local"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
    </custom_item>

    <custom_item>
      type        : CONFIG_CHECK_NOT
      description : "2.3 Disable the Proxy ARP Function - d) No local-proxy-arp"
      info        : "PROXY ARP should be used in networks where the host is not configured with default gateway or there is no routing policy.

						PROXY ARP has negative effects:
						1. ARP traffic on one network segment is increased
						2. The host needs a larger ARP table to process the mapping from IP address to MAC address
						3. Security problems are available, such as ARP spoofing (spoofing)
						4. Does not work for a network that does not use ARP to parse addresses
						5. Network topology cannot be summarized and promoted"
      solution    : "Disable the functions related to Proxy ARP:

						ZXR10 (config)#arp
						ZXR10 (config-arp)#interface fei-0/1/1/13
						ZXR10 (config-arp-if)#no proxy
						ZXR10 (config-arp-if)#no inter-vlan-proxy
						ZXR10 (config-arp-if)#no proxy local
						ZXR10 (config-arp-if)#no local-proxy-arp"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      context     : "^arp"
      item        : ".*local-proxy-arp"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "2.3 Disable the Proxy ARP Function - a) No proxy"
      info        : "PROXY ARP should be used in networks where the host is not configured with default gateway or there is no routing policy.

							PROXY ARP has negative effects:
							1. ARP traffic on one network segment is increased
							2. The host needs a larger ARP table to process the mapping from IP address to MAC address
							3. Security problems are available, such as ARP spoofing (spoofing)
							4. Does not work for a network that does not use ARP to parse addresses
							5. Network topology cannot be summarized and promoted

							Note: The default setting of proxy arp is disabled"
      solution    : "Disable the functions related to Proxy ARP:

							ZXR10 (config)#arp
							ZXR10 (config-arp)#interface fei-0/1/1/13
							ZXR10 (config-arp-if)#no proxy
							ZXR10 (config-arp-if)#no inter-vlan-proxy
							ZXR10 (config-arp-if)#no proxy local
							ZXR10 (config-arp-if)#no local-proxy-arp"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
    </report>

    <report type:"PASSED">
      description : "2.3 Disable the Proxy ARP Function - b) No inter-vlan-proxy"
      info        : "PROXY ARP should be used in networks where the host is not configured with default gateway or there is no routing policy.

							PROXY ARP has negative effects:
							1. ARP traffic on one network segment is increased
							2. The host needs a larger ARP table to process the mapping from IP address to MAC address
							3. Security problems are available, such as ARP spoofing (spoofing)
							4. Does not work for a network that does not use ARP to parse addresses
							5. Network topology cannot be summarized and promoted

							Note: The default setting of proxy arp is disabled"
      solution    : "Disable the functions related to Proxy ARP:

							ZXR10 (config)#arp
							ZXR10 (config-arp)#interface fei-0/1/1/13
							ZXR10 (config-arp-if)#no proxy
							ZXR10 (config-arp-if)#no inter-vlan-proxy
							ZXR10 (config-arp-if)#no proxy local
							ZXR10 (config-arp-if)#no local-proxy-arp"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
    </report>

    <report type:"PASSED">
      description : "2.3 Disable the Proxy ARP Function - c) No proxy local"
      info        : "PROXY ARP should be used in networks where the host is not configured with default gateway or there is no routing policy.

							PROXY ARP has negative effects:
							1. ARP traffic on one network segment is increased
							2. The host needs a larger ARP table to process the mapping from IP address to MAC address
							3. Security problems are available, such as ARP spoofing (spoofing)
							4. Does not work for a network that does not use ARP to parse addresses
							5. Network topology cannot be summarized and promoted

							Note: The default setting of proxy arp is disabled"
      solution    : "Disable the functions related to Proxy ARP:

							ZXR10 (config)#arp
							ZXR10 (config-arp)#interface fei-0/1/1/13
							ZXR10 (config-arp-if)#no proxy
							ZXR10 (config-arp-if)#no inter-vlan-proxy
							ZXR10 (config-arp-if)#no proxy local
							ZXR10 (config-arp-if)#no local-proxy-arp"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
    </report>

    <report type:"PASSED">
      description : "2.3 Disable the Proxy ARP Function - d) No local-proxy-arp"
      info        : "PROXY ARP should be used in networks where the host is not configured with default gateway or there is no routing policy.

							PROXY ARP has negative effects:
							1. ARP traffic on one network segment is increased
							2. The host needs a larger ARP table to process the mapping from IP address to MAC address
							3. Security problems are available, such as ARP spoofing (spoofing)
							4. Does not work for a network that does not use ARP to parse addresses
							5. Network topology cannot be summarized and promoted

							Note: The default setting of proxy arp is disabled"
      solution    : "Disable the functions related to Proxy ARP:

							ZXR10 (config)#arp
							ZXR10 (config-arp)#interface fei-0/1/1/13
							ZXR10 (config-arp-if)#no proxy
							ZXR10 (config-arp-if)#no inter-vlan-proxy
							ZXR10 (config-arp-if)#no proxy local
							ZXR10 (config-arp-if)#no local-proxy-arp"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
    </report>
  </else>
</if>

# 8.4 (2.4) Disable the IP Unreachable Function

<custom_item>
  type        : CONFIG_CHECK
  description : "2.4 Disable the IP Unreachable Function"
  info        : "The ROSNG system product no longer uses U to respond to the icmp request.

					Use icmp unreachable and change the source address to the address of the attacking device to prevent smurf attack"
  solution    : "ZXR10#config terminal
					ZXR10 (config)#icmp-config
					ZXR10 (config-icmp)# interface fei-0/2/1/7
					ZXR10 (config-icmp-if)#no ip unreachable
					ZXR10 (config-icmp-if)#no ipv6 unreachable
					ZXR10 (config-icmp-if)#end"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  context     : "^icmp-config"
  item        : ".*(ip|ipv6) unreachable disable"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
</custom_item>

# 8.6 (2.5) System Product Default Banner

<custom_item>
  type        : CONFIG_CHECK
  description : "2.5 Product Default Banner"
  info        : "Use the banner to modify the system greeting so as to prevent hackers from malicious access to ROSNG system product information."
  solution    : "Configure the system greeting:

					ZXR10 (config)#banner incoming C
					Enter TEXT message. End with the character 'C'.
					'Your greeting message'
					C
					ZXR10 (config)#"
  see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
  item        : "banner incoming .+"
  section     : "system-config"
  reference   : "800-171|3.1.9,800-53|AC-8.,ITSG-33|AC-8,NESA|M1.3.6,TBA-FIISB|45.2.4"
</custom_item>

# 9.1 (3.1) Authentication and Verification of OSPF Routing Protocols

<if>
  <condition type:"AND">
#Check for router opsf interface

    <custom_item>
      type        : CONFIG_CHECK
      description : "Check if ospf routing has been configured"
      item        : "router ospf .+"
    </custom_item>
  </condition>

  <then>
#router opsf interface is configured

    <custom_item>
      type        : CONFIG_CHECK
      description : "3.1 Authentication and Verification of OSPF Routing Protocols - authentication message-digest"
      info        : "To improve network security, the OSPF routing algorithm should support MD5 encryption authentication"
      solution    : "Enable MD5 authentication

						ZXR10 (config-ospf-100-area-1)#authentication message-digest
						ZXR10 (config-ospf-100-if-fei-0/1/0/8.1)#authentication message-digest
						ZXR10 (config-ospf-100-if-fei-0/1/0/8.1)#message-digest-key 1 md5 fffff"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      item        : ".*authentication message-digest"
      reference   : "800-53|IA-3.,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,QCSC-v1|13.2,TBA-FIISB|27.1"
    </custom_item>

    <custom_item>
      type        : CONFIG_CHECK
      description : "3.1 Authentication and Verification of OSPF Routing Protocols - message-digest-key"
      info        : "To improve network security, the OSPF routing algorithm should support MD5 encryption authentication"
      solution    : "Enable MD5 authentication

						ZXR10 (config-ospf-100-area-1)#authentication message-digest
						ZXR10 (config-ospf-100-if-fei-0/1/0/8.1)#authentication message-digest
						ZXR10 (config-ospf-100-if-fei-0/1/0/8.1)#message-digest-key 1 md5 fffff"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      item        : ".*message-digest-key .+ md5 .+"
      reference   : "800-53|IA-3.,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,QCSC-v1|13.2,TBA-FIISB|27.1"
    </custom_item>
  </then>

  <else>
#router opsf interface is not configured

    <report type:"PASSED">
      description : "3.1 Authentication and Verification of OSPF Routing Protocols - authentication message-digest"
      info        : "To improve network security, the OSPF routing algorithm should support MD5 encryption authentication"
      solution    : "Enable MD5 authentication

						ZXR10 (config-ospf-100-area-1)#authentication message-digest
						ZXR10 (config-ospf-100-if-fei-0/1/0/8.1)#authentication message-digest
						ZXR10 (config-ospf-100-if-fei-0/1/0/8.1)#message-digest-key 1 md5 fffff

						Note: Check has not been carried out since OSPF has not been configured."
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-53|IA-3.,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,QCSC-v1|13.2,TBA-FIISB|27.1"
    </report>

    <report type:"PASSED">
      description : "3.1 Authentication and Verification of OSPF Routing Protocols - message-digest-key"
      info        : "To improve network security, the OSPF routing algorithm should support MD5 encryption authentication"
      solution    : "Enable MD5 authentication

						ZXR10 (config-ospf-100-area-1)#authentication message-digest
						ZXR10 (config-ospf-100-if-fei-0/1/0/8.1)#authentication message-digest
						ZXR10 (config-ospf-100-if-fei-0/1/0/8.1)#message-digest-key 1 md5 fffff

						Note: Check has not been carried out since OSPF has not been configured."
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-53|IA-3.,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,QCSC-v1|13.2,TBA-FIISB|27.1"
    </report>
  </else>
</if>

# 9.2 (3.2) Authentication and Verification of ISIS Routing Protocols

<if>
  <condition type:"OR">
#Check for router isis interface

    <custom_item>
      type        : CONFIG_CHECK
      description : "Check if ISIS routing has been configured"
      item        : "router isis .+"
    </custom_item>
  </condition>

  <then>
#router isis interface is configured

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CONFIG_CHECK
          description : "Check if ISIS routing has been configured"
          item        : ".*authentication-type hmac-md5"
        </custom_item>

        <custom_item>
          type        : CONFIG_CHECK
          description : "Check if ISIS routing has been configured"
          context     : "router isis"
          item        : ".*authentication .+"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : CONFIG_CHECK
          description : "3.2 Authentication and Verification of ISIS Routing Protocols - authentication-type hmac-md5"
          info        : "To improve network security, the ISIS routing algorithm should support HMAC-MD5 encryption authentication"
          solution    : "Enable HMAC-MD5 authentication.

							ZXR10 (config-isis-100-if-fei-0/1/0/8.1)#authentication-type hmac-md5
							ZXR10 (config-isis-100-if-fei-0/1/0/8.1)#authentication kkk
							ZXR10 (config-isis-100)#authentication-type hmac-md5
							ZXR10 (config-isis-100)#authentication ffff"
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          item        : ".*authentication-type hmac-md5"
          reference   : "800-53|IA-3.,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,QCSC-v1|13.2,TBA-FIISB|27.1"
        </custom_item>

        <custom_item>
          type        : CONFIG_CHECK
          description : "3.2 Authentication and Verification of ISIS Routing Protocols - authentication"
          info        : "To improve network security, the ISIS routing algorithm should support HMAC-MD5 encryption authentication"
          solution    : "Enable HMAC-MD5 authentication.

							ZXR10 (config-isis-100-if-fei-0/1/0/8.1)#authentication-type hmac-md5
							ZXR10 (config-isis-100-if-fei-0/1/0/8.1)#authentication kkk
							ZXR10 (config-isis-100)#authentication-type hmac-md5
							ZXR10 (config-isis-100)#authentication ffff"
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          item        : ".*authentication .+"
          reference   : "800-53|IA-3.,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,QCSC-v1|13.2,TBA-FIISB|27.1"
        </custom_item>
      </then>

      <else>
        <report type:"FAILED">
          description : "3.2 Authentication and Verification of ISIS Routing Protocols - authentication-type hmac-md5"
          info        : "To improve network security, the ISIS routing algorithm should support HMAC-MD5 encryption authentication

							Note: Either authentication-type hmac-md5 or authentication has not been configured."
          solution    : "Enable HMAC-MD5 authentication.

							ZXR10 (config-isis-100-if-fei-0/1/0/8.1)#authentication-type hmac-md5
							ZXR10 (config-isis-100-if-fei-0/1/0/8.1)#authentication kkk
							ZXR10 (config-isis-100)#authentication-type hmac-md5
							ZXR10 (config-isis-100)#authentication ffff"
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          reference   : "800-53|IA-3.,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,QCSC-v1|13.2,TBA-FIISB|27.1"
        </report>

        <report type:"FAILED">
          description : "3.2 Authentication and Verification of ISIS Routing Protocols - authentication"
          info        : "To improve network security, the ISIS routing algorithm should support HMAC-MD5 encryption authentication

							Note: Either authentication-type hmac-md5 or authentication has not been configured."
          solution    : "Enable HMAC-MD5 authentication.

							ZXR10 (config-isis-100-if-fei-0/1/0/8.1)#authentication-type hmac-md5
							ZXR10 (config-isis-100-if-fei-0/1/0/8.1)#authentication kkk
							ZXR10 (config-isis-100)#authentication-type hmac-md5
							ZXR10 (config-isis-100)#authentication ffff"
          see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
          reference   : "800-53|IA-3.,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,QCSC-v1|13.2,TBA-FIISB|27.1"
        </report>
      </else>
    </if>
  </then>

  <else>
#router isis interface not configured

    <report type:"PASSED">
      description : "3.2 Authentication and Verification of ISIS Routing Protocols - authentication-type hmac-md5"
      info        : "To improve network security, the ISIS routing algorithm should support HMAC-MD5 encryption authentication

							Note: ISIS routing is not configured."
      solution    : "Enable HMAC-MD5 authentication.

							ZXR10 (config-isis-100-if-fei-0/1/0/8.1)#authentication-type hmac-md5
							ZXR10 (config-isis-100-if-fei-0/1/0/8.1)#authentication kkk
							ZXR10 (config-isis-100)#authentication-type hmac-md5
							ZXR10 (config-isis-100)#authentication ffff"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-53|IA-3.,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,QCSC-v1|13.2,TBA-FIISB|27.1"
    </report>

    <report type:"PASSED">
      description : "3.2 Authentication and Verification of ISIS Routing Protocols - authentication"
      info        : "To improve network security, the ISIS routing algorithm should support HMAC-MD5 encryption authentication

							Note: ISIS routing is not configured."
      solution    : "Enable HMAC-MD5 authentication.

							ZXR10 (config-isis-100-if-fei-0/1/0/8.1)#authentication-type hmac-md5
							ZXR10 (config-isis-100-if-fei-0/1/0/8.1)#authentication kkk
							ZXR10 (config-isis-100)#authentication-type hmac-md5
							ZXR10 (config-isis-100)#authentication ffff"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-53|IA-3.,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,QCSC-v1|13.2,TBA-FIISB|27.1"
    </report>
  </else>
</if>

# 9.3 (3.3) Authentication and Verification of BGP Routing Protocols

<if>
  <condition type:"OR">
#Check for router bgp interface

    <custom_item>
      type        : CONFIG_CHECK
      description : "Check if bgp routing has been configured"
      item        : "router bgp .+"
    </custom_item>
  </condition>

  <then>
#router opsf interface is configured

    <custom_item>
      type        : CONFIG_CHECK
      description : "3.3 Authentication and Verification of BGP Routing Protocols"
      info        : "To improve network security, BGP must support MD5 encryption authentication."
      solution    : "Enable MD5 authentication.

					R1 (config-bgp-100)#neighbor 100.100.100.2 password xxx"
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      item        : ".*neighbor .+ password encrypted .+"
      reference   : "800-171|3.5.10,800-53|IA-5(1)(c),CSF|PR.AC-1,ITSG-33|IA-5(1)(c),NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.1"
    </custom_item>
  </then>

  <else>
#router opsf interface is not configured

    <report type:"PASSED">
      description : "3.3 Authentication and Verification of BGP Routing Protocols"
      info        : "To improve network security, BGP must support MD5 encryption authentication."
      solution    : "Enable MD5 authentication.

					R1 (config-bgp-100)#neighbor 100.100.100.2 password xxx

					Note: Check has not been carried out since BGP has not been configured."
      see_also    : "https://support.zte.com.cn/support/doccenter/DocumentProductHandBookDetail.aspx?sid=102&id=30768582&type=docfeedback"
      reference   : "800-171|3.5.10,800-53|IA-5(1)(c),CSF|PR.AC-1,ITSG-33|IA-5(1)(c),NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.1"
    </report>
  </else>
</if>

</check_type>
